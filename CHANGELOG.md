# Change Log

All notable changes to this project will be documented in this file
automatically by Versionist. DO NOT EDIT THIS FILE MANUALLY!
This project adheres to [Semantic Versioning](http://semver.org/).

## v2.14.26 - 2021-10-14

 - Upgrade-2.x: preload update_package in hostapp_based_update [Joseph Kogut]

## v2.14.25 - 2021-10-01

 - Deprecate VARIANT in os-release file [Kyle Harding]

## v2.14.24 - 2021-09-17

 - Temporarily disable upgrades to 2.83.10+rev1 for Pi4 [Kyle Harding]

## v2.14.23 - 2021-09-15

 - Upgrade-2.x: Catch failure when dumping sv update logs [Kyle Harding]

## v2.14.22 - 2021-09-13

 - Upgrade-2.x: apply jetson fix to OS < v2.84.7 [Joseph Kogut]

## v2.14.21 - 2021-09-10

 - Upgrade-2.x.sh: Remove unsupported flag from supervisor upgrade [Kyle Harding]

## v2.14.20 - 2021-08-16

 - Upgrade-2.x.sh: Prevent supervisor update from halting HUP [Kyle Harding]

## v2.14.19 - 2021-06-30

 - Delete CODEOWNERS [Kyle Harding]

## v2.14.18 - 2021-06-10

 - Filter out invalidated hostApp releases [Thodoris Greasidis]

## v2.14.17 - 2021-05-20

 - 2.x: remove resin remnants from ssh script [Matthew McGinn]

## v2.14.16 - 2021-05-20

 - Meta: update codeowners [Matthew McGinn]

## v2.14.15 - 2021-05-06

 - Rename resin-supervisor to balena-supervisor [Kyle Harding]

## v2.14.14 - 2021-04-21

 - Reporting: retry failure reporting until successful [Matthew McGinn]

## v2.14.13 - 2021-04-13

 - Logging: retry reporting failures every minute for an hour [Matthew McGinn]

## v2.14.12 - 2021-03-19

 - ESR: properly grab the meta-balena version from /etc/os-release [Matthew McGinn]

## v2.14.11 - 2021-03-19

 - Supervisor-update: stop the supervisor before PATCHing the new target [Matthew McGinn]

## v2.14.10 - 2021-03-11

 - Private DTs: do not log out from the registry until cleanup [Matthew McGinn]

## v2.14.9 - 2021-03-10

 - Jetson: touch extra_uEnv.txt during HUP to allow supervisor mgmt [Matthew McGinn]

## v2.14.8 - 2021-03-09

 - Jetson: confirm variable exists before testing it [Matthew McGinn]

## v2.14.7 - 2021-02-18

 - Supervisor-upgrade: if the upgrade fails, grab what happened from systemd [Matthew McGinn]

## v2.14.6 - 2021-01-04

 - Supervisor: in case of API query failure, report the received response [Matthew McGinn]

## v2.14.5 - 2020-11-16

 - Rename a bunch of resins to balenas [Matthew McGinn]

## v2.14.4 - 2020-11-16

 - Remove accidentally added file [Matthew McGinn]

## v2.14.3 - 2020-11-12

 - Supervisor-update: use APIKEY when querying for the new target supervisor state [Matthew McGinn]

## v2.14.2 - 2020-11-12

 - Cleanup: remove unused DEVICETYPEJSON variable [Matthew McGinn]

## v2.14.1 - 2020-10-28

 - Meta: remove legacy codeowners [Matthew McGinn]

## v2.14.0 - 2020-10-27

 - Make HUP fetch the device type slug from the API [Stevche Radevski]

## v2.13.18 - 2020-10-19

 - Remove device sanity checks, as they are no longer needed [Hugh Brown]

## v2.13.17 - 2020-10-16

 - Jetson-tx2: migrate other special-case configuration during HUP [Matthew McGinn]

## v2.13.16 - 2020-09-21

 - Post-update-workarounds: allow `hostapp-update` to fail properly [Matthew McGinn]

## v2.13.15 - 2020-09-21

 - Supervisor: wait for upgrade unit to complete [Matthew McGinn]

## v2.13.14 - 2020-09-18

 - Jetson-tx2: rudimentary fix for accidental overwrite of extlinux.conf [Matthew McGinn]

## v2.13.13 - 2020-09-18

 - Meta: dts -> device types for clarity [Matthew McGinn]

## v2.13.12 - 2020-08-17

 - Supervisor: if available, update supervisor without affecting it's state [Matthew McGinn]

## v2.13.11 - 2020-08-05

 - Registry: use provided arg for FQDN rather than local source [Matthew McGinn]

## v2.13.10 - 2020-08-05

 - Log out from the correct REGISTRY_ENDPOINT [Matthew McGinn]

## v2.13.9 - 2020-07-30

 - Use a named key when querying for device by uuid [Matthew McGinn]

## v2.13.8 - 2020-07-17

 - Non-hostapp: fix up retry count non-integer issue [Matthew McGinn]

## v2.13.7 - 2020-06-30

 - Supervisor update: fix bad curl command [Matthew McGinn]

## v2.13.6 - 2020-06-25

 - Variants: remove warning about non-prod [Matthew McGinn]

## v2.13.5 - 2020-06-24

 - Use device uuid not numeric id in legacy scripts [Matthew McGinn]

## v2.13.4 - 2020-06-23

 - Use device uuid not numeric id [Matthew McGinn]

## v2.13.3 - 2020-06-16

 - Remove ascii_downcase function to support old host OSes [Matthew McGinn]

## v2.13.2 - 2020-06-05

 - Fix: backfill missing image variable for legacy upgrades [Matthew McGinn]

## v2.13.1 - 2020-06-05

 - Legacy HUP: image -> target_image for balena registry compat [Matthew McGinn]

## v2.13.0 - 2020-06-05

 - Private dts: enable HUP for access-restricted device types [Matthew McGinn]

## v2.12.6 - 2020-06-03

 - Deltas: fix up service substitution to properly request deltas [Matthew McGinn]

## v2.12.5 - 2020-05-28

 - Error gracefully if number of target releases != 1 [Matthew McGinn]

## v2.12.4 - 2020-05-21

 - Rename: check for balenahup folders existence before symlinking [Matthew McGinn]

## v2.12.3 - 2020-05-21

 - Meta: properly generate nested changelog [Matthew McGinn]

## v2.12.2 - 2020-05-21

 - Meta: add versionbot scaffolding for nested changelogs [Matthew McGinn]

## v2.12.1 - 2020-05-18

 - Rename most resin to balena [Matthew McGinn]

## v2.12.0 - 2020-05-14

 - Remove DockerHub fallback for 2.x HUPs [Matthew McGinn]

## v2.11.3 - 2020-05-14

 - Codeowners: swap zubairlk and saintaardvark [Matthew McGinn]

## v2.11.2 - 2020-05-05

 - Delta HUP: make size log more defensive to handle old jq + bad responses [Matthew McGinn]

## v2.11.1 - 2020-05-04

 - Delta-hup: include size of delta [Matthew McGinn]

## v2.11.0 - 2020-05-01

 - TLS: reuse balenaRootCA to bypass local MitM and self-signed certs [Matthew McGinn]
 - Hostapp-images: try pulling from balena registry before DockerHub [Matthew McGinn]

## v2.10.0 - 2020-04-30

 - Enable delta host OS upgrades [Matthew McGinn]

## v2.9.1 - 2019-12-12

 - Meta: add xginn8 as CODEOWNER [Matthew McGinn]

## v2.9.0 - 2019-11-21

 - Reboot: background subsequent reboot requests to exit cleanly [Matthew McGinn]

## v2.8.3 - 2019-11-21

 - Silence stderr that causes "failed" HUPs [Matthew McGinn]

## v2.8.2 - 2019-11-06

 - Meta: update CODEOWNERS [Matthew McGinn]

## v2.8.1 - 2019-11-06

 - Replace "nohup ..." with "systemd reboot" in reboot requests [Gergely Imreh]

## v2.8.0 - 2019-09-02

 - Upgrade-2.x: Do not error out when getting a .dev device version [Gergely Imreh]

## v2.7.0 - 2019-08-28

 - Remove "--nolog" flag from 2.x updater, and always set up logfile [Gergely Imreh]

## v2.6.8 - 2019-06-19

 - Logging: redirect ERROR messages to stderr (to pass back to the proxy) [Matthew McGinn]

## v2.6.7 - 2019-05-29

 - Typo: fix up minor exsits typo [Matthew McGinn]

## v2.6.6 - 2019-05-23

 - Upgrade-2.x: allow extra version format [Gergely Imreh]

## v2.6.5 - 2019-05-09

 - Upgrade-2.x: sanitize persistent logging device config vars [Gergely Imreh]

## v2.6.4 - 2019-04-25

 - Upgrade-1.x-to-2.x: also set the supervisor image name during update [Gergely Imreh]

## v2.6.3 - 2019-04-24

 - Upgrade-2.x: increase timeout values during update to 5 minutes [Gergely Imreh]

## v2.6.2 - 2019-04-23

 - Upgrade-1.x-to-2.x: unify data partition unmounting and add preventing umount step [Gergely Imreh]

## v2.6.1 - 2019-04-23

 - Upgrade-1.x: also use supervisor registry if set [Gergely Imreh]

## v2.6.0 - 2019-04-23

 - Upgrade-1.x: use the new 1.x HUP image, and allow setting the v1 registry [Gergely Imreh]

## v2.5.0 - 2019-04-23

 - Hup-1.x: allow updater to take a v1 Docker registry URL [Gergely Imreh]

## v2.4.1 - 2019-04-11

 - Upgrade 1x2x/2x: bump API calls to the latest API version [Gergely Imreh]

## v2.4.0 - 2019-03-29

 - Upgrade-2.x: redo supported device slug test [Gergely Imreh]

## v2.3.5 - 2019-03-19

 - Upgrade-2.x: Namespaced creation temporary folder [Gergely Imreh]

## v2.3.4 - 2019-03-19

 - Upgrade-2.x: user tempfile for FIFO [Gergely Imreh]

## v2.3.3 - 2019-03-12

 - Upgrade-1.x-to-2.x: do not umount the boot partition [Gergely Imreh]
 - Upgrade-1.x-to-2.x: add sync to every copy step [Gergely Imreh]
 - Upgrade-1.x-to-2.x: erase partition always before creating ext4 [Gergely Imreh]

## v2.3.2 - 2019-03-12

 - Add CODEOWNERS [Gergely Imreh]

## v2.3.1 - 2019-02-05

 - Upgrade-1x-to-2x: add retries to the docker pull step [Gergely Imreh]

## v2.3.0 - 2019-01-24

 - Add retries to all curl calls for more robustness [Gergely Imreh]

## v2.2.1 - 2019-01-23

 - Upgrade-2.x: expand on leftover data clearence after interrupted update [Gergely Imreh]

## v2.2.0 - 2019-01-22

 - Upgrade-2.x: Add whitelist for imx8m-var-dart and cl-som-imx8 device types [Gergely Imreh]

## v2.1.9 - 2019-01-10

 - Upgrade-1.x-to-2.x: Fix incorrect migration to the state partition [Gergely Imreh]

## v2.1.8 - 2019-01-09

 - Upgrade-1.x-to-2.x: Add sync after going read-only for safety [Gergely Imreh]

## v2.1.7 - 2018-11-26

 - Upgrade-2.x: Clean up inactive docker/balena folder if needed [Gergely Imreh]

## v2.1.6 - 2018-11-22

 - Upgrade-2.x: Remove supervisor container not just stop [Gergely Imreh]

## v2.1.5 - 2018-11-20

 - Upgrade-1.x: Properly handle updates to logstream 1.x versions [Gergely Imreh]

## v2.1.4 - 2018-11-09

 - Upgrade-2.x: Properly remove update image when needed [Gergely Imreh]

## v2.1.3 - 2018-11-09

 - Upgrade-2.x: Fix balena migration [Gergely Imreh]

## v2.1.2 - 2018-11-01

 - Upgrade-2.x: add retries to docker pull where we expect timeouts [Gergely Imreh]
 - Resinhup.conf: Remove unused mixpanelToken variable [Juan Cruz Viotti]
 - Upgrade-1.x-to-2.x: Fixup of supervisor updater edge case [Gergely Imreh]

## v2.1.1 - 2018-10-18

 - Upgrade-1.x-to-2.x: Get the supervisor version from the new root [Gergely Imreh]

## v2.1.0 - 2018-10-02

 - Upgrade-2.x: Add support for new boards [Gergely Imreh]

## v2.0.1 - 2018-09-05

 - Upgrade-2.x: Only switch docker to single download where available [Gergely Imreh]

## v2.0.0 - 2018-09-05

 - Upgrade-2.x: Add support for ARTIK530/ARTIK533s device types [Gergely Imreh]
 - Upgrade-2.x: add orbitty-tx2 to supported device types [Gergely Imreh]
 - Upgrade-2.x: Update OS version check for update-resin-supervisor fix [Gergely Imreh]
 - Update-2.x: resinOS >=2.13.1 does not have timesyncd so no need to fix [Gergely Imreh]
 - Upgrade-1.x-to-2.x: when switching root partitions, run check after writing [Gergely Imreh]
 - Update-2.x: workaround for RPi1 2.x devices not being able do some docker pulls [Gergely Imreh]
 - Upgrade-1.x-to-2.x: modify docker daemon flags for in target system [Gergely Imreh]
 - Upgrade-1.x-to-2.x: force dd to physically write stuff to disk before finishing [Gergely Imreh]
 - When first umounting file systems, also stop the relevant systemd services [Gergely Imreh]
 - Fix cleaning up resinOS update package [Gergely Imreh]
 - Adding support for the Banana Pi M1 and the Dart board [Gergely Imreh]
 - Adding support for more devices [Gergely Imreh]
 - Upgrade-2.x: add support for TX1 updates [Gergely Imreh]
 - Upgrade-2.x: clean up after in-container resinOS updates [Gergely Imreh]
 - Upgrade-1.x-to-2.x/-2.x: replace $SECONDS with iteration counter [Gergely Imreh]
 - Upgrade-1.x-to-2.x: add missing umount and make umounts robust [Gergely Imreh]
 - Upgrade-2.x: combine supported ARM device types into a single check [Gergely Imreh]
 - Upgrade-1.x-to-2.x: add support to upgrade the Intel NUC [Gergely Imreh]
 - Upgrade-2.x: add new flag to assume supported device [Gergely Imreh]
 - Upgrade-2.x: upgrading a `.dev` device switched from error to warning [Gergely Imreh]
 - Upgrade/upgrade-ssh all versions: if no option supplied, just show the help [Gergely Imreh]
 - Upgrade-1.x/1.x-to-2.x/2.x: lockfile improvements [Gergely Imreh]
 - Upgrade-2.x: add support for the Artik710 device type [Gergely Imreh]
 - Upgrade-1.x and upgrade-ssh-1.x: moving/adapting scripts from meta-resin [Gergely Imreh]
 - Upgrade_2.x: change when to remove containers for supervisor updates [Gergely Imreh]
 - Upgrade-2.x.sh: fix issues with `read` on newer resinOS versions [Gergely Imreh]
 - Running upgrade scripts over new type of SSH access [Gergely Imreh]
 - Upgrade scripts: use lockfile to prevent multiple updates running [Gergely Imreh]
 - Upgrade-2.x: add flag to stop user application before updates [Gergely Imreh]
 - Upgrade-2.x: add support for Intel Edison updates on resinOS 2.x [Gergely Imreh]
 - Upgrade-2.x: fix balena migration for non-hostapp-mode hostapp enabled resinOS (#143) [Gergely Imreh]
 - Upgrade-2.x: typo in script [Gergely Imreh]
 - Upgrade-2.x: add QEMU support for resinHUP scripts [Gergely Imreh]
 - Upgrade-2.x: add support for ts4900 device type [Gergely Imreh]
 - Upgrade-2.x: add support for Jetson TX2 and related devices [Gergely Imreh]
 - Upgrade-2.x: remove supervisor database after upgrade for some versions [Gergely Imreh]
 - Upgrade-2.x: fixing up help text, making --staging more safe [Gergely Imreh]
 - Upgrade-2.x: new flags to pull resinOS from custom repository [Gergely Imreh]
 - Upgrade-2.x: adding support for iot2000 board [Gergely Imreh]
 - Upgrade-2.x: balena migration fixes [Gergely Imreh]
 - Upgrade-2.x: check supervisor version based on the target image [Gergely Imreh]
 - Upgrade-1x-to-2x/upgrade-2x: update progress messages based on feedback [Gergely Imreh]
 - Upgrade-1.x-to-2.x: check if btrfs partition was successfully umounted [Gergely Imreh]
 - Upgrade-2x: enable hostapp-update based updates through resinhup (#112) [Gergely Imreh]
 - Upgrade-scripts: fix indentations [Gergely Imreh]
 - Upgrade-1.x-to-2.x: unify ext4 file system creation as it is done on 2.x [Gergely Imreh]
 - Adding bootfile patch that is required for the hostapps update for some versions [Gergely Imreh]
 - Upgrade-1.x-to-2.x: static IP migration [Gergely Imreh]
 - Upgrade-1.x-to-2.x: supervisor bootstrap add highest target version [Gergely Imreh]
 - Upgrade-2.x: update-resin-supervisor polyfill for 2.0.8-2.7.0 versions [Gergely Imreh]
 - Upgrade-1.x-to-2.x: fix typo in function name [Gergely Imreh]
 - Upgrade-1.x-to-2.x: connman config changes only when required [Gergely Imreh]
 - Upgrade-1.x-to-2.x: for resinOS versions with supervisor v6.2.0-v6.3.4 bump it [Gergely Imreh]
 - Upgrade-ssh-1.x-to-2.x: allow "--nolog" to be passed to the update script [Gergely Imreh]
 - Upgrade-1.x-to-2.x: bail out with an error if resin-data backup fails [Gergely Imreh]
 - Upgrade-2.x: fixes to issues highlighted by shellcheck [Gergely Imreh]
 - Upgrade-2.x: fix nolog command line parameter for the over-the-ssh updater [Gergely Imreh]
 - Upgrade-2.x: rewrite nmcli check for resin-sample [Gergely Imreh]
 - Upgrade-2.x: enable --nolog flag for the running-over-ssh script [Gergely Imreh]
 - Upgrade-2.x: add the first sanity check for the update (device type check) [Gergely Imreh]
 - Upgrade-1.x-to-2.x: fix up start-resin-supervisor for some versions [Gergely Imreh]
 - Upgrade-2.x: update APIKEY getting logic [Gergely Imreh]
 - Upgrade-1.x-to-2.x: check whether the target resinOS version exists in registry [Gergely Imreh]
 - Upgrade-2.x: check whether the target resinOS version exists in registry [Gergely Imreh]
 - Upgrade-2.x: possibility of redirecting complete script output to file [Gergely Imreh]
 - Upgrade-1.x-to-2.x: possibility of redirecting complete script output to file [Gergely Imreh]
 - Upgrade-2.x: better version string normalization and defensive checking [Gergely Imreh]
 - Upgrade-1.x-to-2.x: fixing typo in status message [Gergely Imreh]
 - Upgrade-1.x-to-2.x: bail out if cannot download update package [Gergely Imreh]
 - Upgrade-1.x-to-2.x: bump up minimum Beaglebone hostos starting version [Gergely Imreh]
 - Upgrade-2.x: switch order of root partition switch and supervisor upgrade [Gergely Imreh]
 - Upgrade-2.x: enable using staging resinOS docker hub repository [Gergely Imreh]
 - Ugrade-1.x-to-2.x: changes to go into the self-service HUP [Gergely Imreh]
 - Upgrade-2.x: add options to log to file [Gergely Imreh]
 - Upgrade-1.x-to-2.x: pre-check for wifi-config settings migrations [Gergely Imreh]
 - Upgrade-1.x-to-2.x: adding extra functionality into the upgrade [Gergely Imreh]
 - Upgrade-2.x: make supervisor update issues errors instead of warnings [Gergely Imreh]
 - Upgrade-2.x: explicitly stop services, instead of doing it in dependent function [Gergely Imreh]
 - Upgrade-2.x: restart supervisor if there's an error in the script [Gergely Imreh]
 - Upgrade-2.x: add shellcheck exception to docker calls [Gergely Imreh]
 - Upgrade-2.x: more defensive supervisor upgrade script [Gergely Imreh]
 - Upgrade-2.x: change supervisor upgrade function's name [Gergely Imreh]
 - Upgrade-2.x: update download URI for x86 tools now that they are merged [Gergely Imreh]
 - Upgrade-2.x: check VERSION_ID for resin-device-progress patch [Gergely Imreh]
 - Upgrade-2.x: add patching resin-supervisor-progress on affected versions [Gergely Imreh]
 - Upgrade-2.x: add explicit supervisor update command line argument [Gergely Imreh]
 - Upgrade-2.x: at the end of the supervisor update remove existing containers [Gergely Imreh]
 - Upgrade-1.x-to-2.x: migrate root partition when it's read-only [Gergely Imreh]
 - Updater-2.x: add displayed status for supervisor update stage [Gergely Imreh]
 - Upgrade-1.x-to-2.x: add more log output [Gergely Imreh]
 - Upgrade-1.x-to-2.x: migrate wifi connections to the boot partition [Gergely Imreh]
 - Upgrade-2.x: updating supervisor versions at the end of the update [Gergely Imreh]
 - Upgrade-2.x: only upgrade "prod" devices [Gergely Imreh]
 - Upgrade-1.x-to-2.x: set new target versions [Gergely Imreh]
 - Upgrade-1.x-to-2.x: also migrate resin-wifi-connect configuration [Gergely Imreh]
 - Updater-2.x: up-board support [Gergely Imreh]
 - Updater-2.x: add progress bars [Gergely Imreh]
 - Updater-2.x: extract hup package without an intermediate file [Gergely Imreh]
 - Upgrade-2.x: fix tool downloads and be more defensive about it. [Gergely Imreh]
 - Upgrade-1.x-to-2.x: fixes since initial merge [Gergely Imreh]
 - Add 2.x upgrade script [Will Newton]
 - Add script to perform 1.x to 2.x migration [Will Newton]
 - Upgrade-binaries: Add static binaries for legacy upgrades [Will Newton]

## v1.2.1 - 2017-07-12

 - Artik5: update to Alpine-based image as well [Gergely Imreh]

## v1.2.0 - 2017-07-12

 - Versionist: add support for versionist generation of CHANGELOG.md [Gergely Imreh]
 - Alpine based resinHUP images [Gergely Imreh]

## v1.1.4 - 2017-06-08

 - legacy-config: fix copy bug when migrating config.json [Gergely]

## v1.1.3 - 2017-05-25

 - Whitelist etc/hostname [Gergely]

## v1.1.2 - 2017-05-16

 - Whitelist etc/openvpn/resin.conf to allow resinhup on staging [Will]

## v1.1.1 - 2017-01-23

 - Implement ability to downgrade through argument and environment variable [Andrei]

## v1.1.0 - 2017-01-19

 - Whitelist splash logo [Michal]
 - Implement retry mechanism in pulling resinos image [Michal]
 - Artik 5 support [Andrei]

## v1.0.0 - 2016-12-23

 - Fix ignore directories when iterating [Andrei]
 - Add support for dockerhub based update packages [Andrei]
 - Implement version and remote arguments [Andrei]
